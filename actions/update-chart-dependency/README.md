# Update Helm Chart Dependencies GitHub Action

> Generated by Copilot

This GitHub Action updates the version of a specific dependency in the `Chart.yaml` (and optionally `helmfile.yaml`) for one or more Helm charts in your Kubernetes project, creates a branch with the changes, and opens a pull request.

## Features

- Accepts a dependency service name and version as inputs.
- Finds all chart directories (optionally filtered by prefix).
- Updates the dependency version in each chart's `Chart.yaml` and `helmfile.yaml` if present.
- Creates a new branch from a specified base branch.
- Commits all changes and opens a PR with a summary of updated charts.
- Uses only Node.js built-in modules and the official GitHub Actions toolkit.
- All commits are annotated with `Generated by Copilot`.

## Inputs

| Name           | Description                                                                                              | Required | Default |
| -------------- | -------------------------------------------------------------------------------------------------------- | -------- | ------- |
| `service-name` | Name of the dependency to update in Chart.yaml/helmfile.yaml.                                            | true     |         |
| `version`      | New version to set for the dependency.                                                                   | true     |         |
| `github-token` | GitHub token for authentication.                                                                         | true     |         |
| `chart-prefix` | Prefix to filter chart directories. Only charts whose directory starts with this prefix will be updated. | false    |         |
| `branch`       | Branch to base the PR on (e.g. `main`).                                                                  | false    | `main`  |

## Usage

```yaml
- name: Update Helm Chart Dependencies
  uses: map-colonies/update-chart-dependency@v1
  with:
    service-name: 'my-dependency'
    version: '1.2.3'
    github-token: ${{ secrets.GITHUB_TOKEN }}
    chart-prefix: 'myservice-'
    branch: 'main'
```

## Notes

- The action updates only the version of the specified dependency in each chart's `Chart.yaml` and `helmfile.yaml`.
- The action opens a single PR for all updated charts.
- If no charts require updating, no PR will be opened.
- All commits are annotated with `Generated by Copilot`.

## License

MIT
